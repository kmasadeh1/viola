<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard | Viola Academy</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js"></script>

    <style>
        /* Shared Styles */
        .drop-zone {
            width: 100%;
            height: 150px;
            padding: 20px;
            border: 2px dashed #ccc;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            cursor: pointer;
            background: #f8f9fa;
            margin-bottom: 15px;
            position: relative;
        }

        .drop-zone.dragover {
            background-color: #e8f5e9;
            border-color: #2ecc71;
            transform: scale(1.02);
        }

        .preview-img,
        #lunchPreview {
            max-height: 100%;
            max-width: 100%;
            display: none;
            border-radius: 5px;
            object-fit: contain;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 2rem;
            width: 90%;
            max-width: 600px;
            border-radius: 15px;
        }

        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-top: 5px;
        }

        .btn {
            padding: 10px 20px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            font-weight: bold;
        }

        .btn-primary {
            background: #2ecc71;
            color: white;
        }

        .btn-secondary {
            background: #3498db;
            color: white;
        }

        .btn-danger {
            background: #e74c3c;
            color: white;
        }

        .btn-warning {
            background: #f1c40f;
            color: white;
        }

        .btn-info {
            background: #17a2b8;
            color: white;
        }

        .admin-timeline-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 8px;
            border-left: 4px solid #2ecc71;
        }

        .btn-delete-sm {
            background: #ffebee;
            color: red;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .schedule-row {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
            animation: fadeIn 0.3s ease;
        }

        .schedule-time {
            width: 100px;
            font-weight: bold;
            color: #555;
        }

        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .msg-history-item {
            border-left: 4px solid #e74c3c;
            background: #fff;
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .order-card {
            background: white;
            border: 1px solid #eee;
            border-left: 5px solid #f1c40f;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 5px;
        }

        .login-section {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #90caf9;
            margin-bottom: 15px;
            grid-column: span 2;
        }

        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            height: 300px;
        }

        .homework-item {
            background: #fff;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .homework-badge {
            font-size: 0.8rem;
            padding: 4px 8px;
            border-radius: 4px;
            background: #eee;
            color: #555;
            margin-right: 5px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
        }

        .data-table th,
        .data-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .data-table th {
            background: #f8f9fa;
            font-weight: bold;
            color: #555;
        }

        .list-group-item {
            border: 1px solid #eee;
            border-radius: 5px;
            margin-bottom: 5px;
        }

        .rc-input {
            width: 80px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 5px;
        }

        .rc-header-controls {
            display: flex;
            gap: 15px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            align-items: flex-end;
            flex-wrap: wrap;
        }

        .settings-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #eee;
        }

        .settings-header {
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        /* Transfer List Styles */
        .transfer-list {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #eee;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }

        .transfer-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 5px;
            border-bottom: 1px solid #f9f9f9;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Toast Notification Styles */
        .toast-msg {
            min-width: 250px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            display: flex;
            align-items: center;
            gap: 10px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
            animation: slideIn 0.3s forwards;
        }

        .toast-success {
            background-color: #2ecc71;
            border-left: 5px solid #27ae60;
        }

        .toast-error {
            background-color: #e74c3c;
            border-left: 5px solid #c0392b;
        }

        .toast-info {
            background-color: #3498db;
            border-left: 5px solid #2980b9;
        }

        @keyframes slideIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
                transform: translateX(100%);
            }
        }
    </style>
</head>

<body>
    <div class="lang-toggle" onclick="toggleLanguage()"><i class="fas fa-globe"></i> <span>English / العربية</span>
    </div>
    <nav>
        <div class="logo-container">
            <img src="public/logo.jpg" alt="Logo" class="nav-logo">
            <div class="brand-name" id="navBrandName">Viola Admin</div>
        </div>
        <ul class="nav-links">
            <li><a href="index.html" data-en="Log Out" data-ar="تسجيل الخروج">Log Out</a></li>
        </ul>
    </nav>
    <div class="admin-layout">
        <div class="admin-sidebar">
            <button class="sidebar-btn active" onclick="showPanel('students')"><i class="fas fa-user-graduate"></i>
                <span data-en="Students" data-ar="الطلاب">Students</span></button>
            <button class="sidebar-btn" onclick="showPanel('teachers')"><i class="fas fa-chalkboard-teacher"></i> <span
                    data-en="Teachers" data-ar="المعلمين">Teachers</span></button>
            <button class="sidebar-btn" onclick="showPanel('classes')"><i class="fas fa-layer-group"></i> <span
                    data-en="Classes" data-ar="الصفوف">Classes</span></button>
            <button class="sidebar-btn" onclick="showPanel('report-cards')"><i class="fas fa-file-alt"></i> <span
                    data-en="Report Cards" data-ar="الشهادات">Report Cards</span></button>
            <button class="sidebar-btn" onclick="showPanel('shop')"><i class="fas fa-tshirt"></i> <span data-en="Shop"
                    data-ar="المتجر">Shop</span></button>
            <button class="sidebar-btn" onclick="showPanel('schedule')"><i class="fas fa-calendar-week"></i> <span
                    data-en="Schedule" data-ar="الجدول">Schedule</span></button>
            <button class="sidebar-btn" onclick="showPanel('homework')"><i class="fas fa-book"></i> <span
                    data-en="Homework" data-ar="الواجبات">Homework</span></button>
            <button class="sidebar-btn" onclick="showPanel('bus')"><i class="fas fa-bus"></i> <span data-en="Bus"
                    data-ar="الحافلات">Bus</span></button>
            <button class="sidebar-btn" onclick="showPanel('lunch')"><i class="fas fa-utensils"></i> <span
                    data-en="Lunch" data-ar="الغداء">Lunch</span></button>
            <button class="sidebar-btn" onclick="showPanel('gallery')"><i class="fas fa-images"></i> <span
                    data-en="Gallery" data-ar="المعرض">Gallery</span></button>
            <button class="sidebar-btn" onclick="showPanel('messages')"><i class="fas fa-bullhorn"></i> <span
                    data-en="Broadcast" data-ar="الإعلانات">Broadcast</span></button>
            <button class="sidebar-btn" onclick="showPanel('settings')"><i class="fas fa-cog"></i> <span
                    data-en="Settings" data-ar="الإعدادات">Settings</span></button>
            <button class="sidebar-btn" onclick="showPanel('website-editor')">
                <i class="fas fa-laptop-code"></i> <span data-en="Website Editor" data-ar="محرر الموقع">Website
                    Editor</span>
            </button>
        </div>
        <div class="admin-content">

            <div id="students" class="panel active">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                    <h2 data-en="Student & Fee Management" data-ar="إدارة الطلاب والرسوم">Student & Fee Management</h2>
                    <div><button class="btn btn-secondary" style="margin-right: 10px;" onclick="exportToPDF()"><i
                                class="fas fa-file-pdf"></i> <span data-en="Export PDF" data-ar="تصدير PDF">Export
                                PDF</span></button><button class="btn btn-primary" onclick="openStudentModal()"><span
                                data-en="+ Create Account" data-ar="+ إنشاء حساب">+ Create Account</span></button></div>
                </div>
                <div class="row mb-4" style="display: flex; gap: 20px; flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 300px;">
                        <div class="chart-container">
                            <h5 class="text-muted mb-3" data-en="Financial Overview" data-ar="نظرة عامة مالية">Financial
                                Overview</h5><canvas id="feesChart"></canvas>
                        </div>
                    </div>
                    <div style="flex: 1; min-width: 300px;">
                        <div class="chart-container">
                            <h5 class="text-muted mb-3" data-en="Attendance Trends (6 Months)"
                                data-ar="اتجاهات الحضور (6 أشهر)">Attendance Trends (6 Months)</h5><canvas
                                id="attendanceChart"></canvas>
                        </div>
                    </div>
                </div>
                <div
                    style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; display: flex; gap: 15px; flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 200px;"><label><strong data-en="Filter by Section:"
                                data-ar="تصفية حسب الصف:">Filter by Section:</strong></label><select id="sectionFilter"
                            class="form-control class-dropdown" onchange="renderTable()">
                            <option value="All">Show All</option>
                        </select></div>
                    <div style="flex: 2; min-width: 200px;"><label><strong data-en="Search Student:"
                                data-ar="بحث عن طالب:">Search Student:</strong></label>
                        <div style="position: relative;"><input type="text" id="studentSearch" class="form-control"
                                placeholder="Search by Name or ID..." onkeyup="renderTable()"
                                style="padding-left: 35px;"><i class="fas fa-search"
                                style="position: absolute; left: 12px; top: 12px; color: #999;"></i></div>
                    </div>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div>
                            <h4 data-en="Total Students" data-ar="مجموع الطلاب">Total Students</h4>
                            <h2 id="totalStudentsCount" style="color: #3498db;">0</h2>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div>
                            <h4 data-en="Total Fees Collected" data-ar="مجموع الرسوم المحصلة">Total Fees Collected</h4>
                            <h2 id="totalRevenue" style="color: #2ecc71;">0 JOD</h2>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div>
                            <h4 data-en="Outstanding Fees" data-ar="الرسوم المتبقية">Outstanding Fees</h4>
                            <h2 id="totalOutstanding" style="color: #e74c3c;">0 JOD</h2>
                        </div>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th data-en="Login ID" data-ar="اسم المستخدم">Login ID</th>
                            <th data-en="Name" data-ar="الاسم">Name</th>
                            <th data-en="Section" data-ar="الصف">Section</th>
                            <th data-en="Fees Paid / Total" data-ar="المدفوع / الكلي">Fees Paid / Total</th>
                            <th data-en="Credit" data-ar="الرصيد">Credit</th>
                            <th data-en="Actions" data-ar="إجراءات">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="studentTableBody"></tbody>
                </table>
            </div>

            <div id="report-cards" class="panel" style="display:none;">
                <h2 data-en="Report Card Management" data-ar="إدارة الشهادات المدرسية" style="margin-bottom: 20px;">
                    Report Card Management</h2>
                <div class="rc-header-controls">
                    <div style="flex: 1; min-width: 200px;"><label class="fw-bold text-muted small"
                            data-en="1. Select Class" data-ar="1. اختر الصف">1. Select Class</label><select
                            id="rcClassSelect" class="form-control class-dropdown" onchange="loadRCStudents()"></select>
                    </div>
                    <div style="flex: 1; min-width: 200px;"><label class="fw-bold text-muted small"
                            data-en="2. Select Student" data-ar="2. اختر الطالب">2. Select Student</label><select
                            id="rcStudentSelect" class="form-control" onchange="renderAdminReportCard()"></select></div>
                    <div style="flex: 1; min-width: 200px;"><label class="fw-bold text-muted small"
                            data-en="3. Select Term" data-ar="3. اختر الفصل">3. Select Term</label><select
                            id="rcTermSelect" class="form-control" onchange="renderAdminReportCard()">
                            <option value="First Semester">First Semester</option>
                            <option value="Second Semester">Second Semester</option>
                        </select></div>
                </div>
                <div id="rcEditorArea" style="display: none;">
                    <div
                        style="background: white; padding: 2rem; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.05);">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h4 style="margin: 0;"><i class="fas fa-edit text-primary"></i> <span
                                    id="rcStudentNameDisplay">Student</span> - <span id="rcTermDisplay">Term</span></h4>
                            <button class="btn btn-secondary" onclick="downloadAdminReportCardPDF()"><i
                                    class="fas fa-download"></i> <span data-en="Download PDF"
                                    data-ar="تحميل PDF">Download PDF</span></button>
                        </div>
                        <table class="data-table" id="adminRcTable">
                            <thead>
                                <tr>
                                    <th data-en="Subject" data-ar="المادة">Subject</th>
                                    <th data-en="Score" data-ar="الدرجة">Score</th>
                                    <th data-en="Grade" data-ar="التقدير">Grade</th>
                                </tr>
                            </thead>
                            <tbody id="rcTableBody"></tbody>
                        </table>
                        <div style="margin-top: 20px; text-align: right;"><button class="btn btn-primary"
                                onclick="saveAdminGrades()"><i class="fas fa-save"></i> <span data-en="Save Changes"
                                    data-ar="حفظ التغييرات">Save Changes</span></button></div>
                    </div>
                </div>
            </div>

            <div id="teachers" class="panel" style="display:none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                    <h2 data-en="Teacher Management" data-ar="إدارة المعلمين">Teacher Management</h2><button
                        class="btn btn-primary" onclick="openTeacherModal()"><span data-en="+ Add Teacher"
                            data-ar="+ إضافة معلم">+ Add Teacher</span></button>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th data-en="Name" data-ar="الاسم">Name</th>
                            <th data-en="Assigned Class" data-ar="الصف المعين">Assigned Class</th>
                            <th data-en="Username" data-ar="اسم المستخدم">Username</th>
                            <th data-en="Password" data-ar="كلمة المرور">Password</th>
                            <th data-en="Actions" data-ar="إجراءات">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="teacherTableBody"></tbody>
                </table>
            </div>

            <div id="classes" class="panel" style="display:none;">
                <h2 data-en="Class Management" data-ar="إدارة الصفوف">Class Management</h2>
                <div class="row">
                    <div class="col-md-6">
                        <div style="background: white; padding: 20px; border-radius: 12px; margin-top: 20px;">
                            <h5 data-en="Add New Class" data-ar="إضافة صف جديد">Add New Class</h5>
                            <div class="d-flex gap-2 mb-3"><input type="text" id="newClassName"
                                    class="form-control mt-0" placeholder="e.g. Grade 1 A"><button
                                    class="btn btn-success" onclick="addClass()"><span data-en="Add"
                                        data-ar="إضافة">Add</span></button></div>
                            <hr>
                            <h5 data-en="Existing Classes" data-ar="الصفوف الحالية">Existing Classes</h5>
                            <ul id="classList" class="list-group mt-2" style="list-style: none; padding: 0;"></ul>
                        </div>
                    </div>
                </div>
            </div>

            <div id="shop" class="panel" style="display:none;">
                <h2 data-en="Shop & Order Manager" data-ar="إدارة المتجر والطلبات">Shop & Order Manager</h2>
                <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 300px; background: white; padding: 20px; border-radius: 10px;">
                        <h3 style="margin-bottom: 15px; color: var(--primary);" data-en="Incoming Orders"
                            data-ar="الطلبات الواردة">Incoming Orders</h3>
                        <div id="ordersContainer" style="max-height: 500px; overflow-y: auto;">
                            <p class="text-muted" data-en="No pending orders." data-ar="لا يوجد طلبات معلقة.">No pending
                                orders.</p>
                        </div>
                    </div>
                    <div style="flex: 1; min-width: 300px; background: white; padding: 20px; border-radius: 10px;">
                        <h3 style="margin-bottom: 15px;" data-en="Edit Uniforms" data-ar="تعديل الزي المدرسي">Edit
                            Uniforms</h3>
                        <div style="margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 20px;">
                            <h4 style="color: orange; margin-bottom: 5px;" data-en="Summer Uniform"
                                data-ar="الزي الصيفي">Summer Uniform</h4>
                            <div class="drop-zone" style="height: 100px; margin-bottom: 10px;"
                                onclick="document.getElementById('summerInput').click()">
                                <p data-en="Click to Upload Image" data-ar="انقر لرفع صورة">Click to Upload Image</p>
                                <img id="summerPreview" class="preview-img"><input type="file" id="summerInput" hidden
                                    accept="image/*">
                            </div><input type="text" id="summerDesc" class="form-control"
                                placeholder="Description"><input type="number" id="summerPrice" class="form-control"
                                placeholder="Price">
                        </div>
                        <div>
                            <h4 style="color: #3498db; margin-bottom: 5px;" data-en="Winter Uniform"
                                data-ar="الزي الشتوي">Winter Uniform</h4>
                            <div class="drop-zone" style="height: 100px; margin-bottom: 10px;"
                                onclick="document.getElementById('winterInput').click()">
                                <p data-en="Click to Upload Image" data-ar="انقر لرفع صورة">Click to Upload Image</p>
                                <img id="winterPreview" class="preview-img"><input type="file" id="winterInput" hidden
                                    accept="image/*">
                            </div><input type="text" id="winterDesc" class="form-control"
                                placeholder="Description"><input type="number" id="winterPrice" class="form-control"
                                placeholder="Price">
                        </div><button class="btn btn-primary" onclick="saveShopSettings()"
                            style="width: 100%; margin-top: 20px;"><span data-en="Save Changes"
                                data-ar="حفظ التغييرات">Save Changes</span></button>
                    </div>
                </div>
            </div>

            <div id="schedule" class="panel" style="display:none;">
                <h2 data-en="Weekly Schedule Editor" data-ar="محرر الجدول الأسبوعي">Weekly Schedule Editor</h2>
                <div
                    style="display: flex; gap: 20px; margin-bottom: 20px; background: white; padding: 20px; border-radius: 10px;">
                    <div style="flex: 1;"><label><strong data-en="1. Select Class" data-ar="1. اختر الصف">1. Select
                                Class</strong></label><select id="scheduleClass" class="form-control class-dropdown"
                            onchange="loadDaySchedule()"></select></div>
                    <div style="flex: 1;"><label><strong data-en="2. Select Day" data-ar="2. اختر اليوم">2. Select
                                Day</strong></label><select id="scheduleDay" class="form-control"
                            onchange="loadDaySchedule()">
                            <option value="0" data-en="Sunday" data-ar="الأحد">Sunday</option>
                            <option value="1" data-en="Monday" data-ar="الاثنين">Monday</option>
                            <option value="2" data-en="Tuesday" data-ar="الثلاثاء">Tuesday</option>
                            <option value="3" data-en="Wednesday" data-ar="الأربعاء">Wednesday</option>
                            <option value="4" data-en="Thursday" data-ar="الخميس">Thursday</option>
                        </select></div>
                </div>
                <div style="background: white; padding: 2rem; border-radius: 10px;">
                    <h4 data-en="Manage Time Slots" data-ar="إدارة الأوقات">Manage Time Slots</h4>
                    <div
                        style="display: flex; gap: 10px; align-items: flex-end; margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid #eee;">
                        <div style="flex: 1;"><label style="font-size: 0.85rem; color: #666;" data-en="New Time"
                                data-ar="وقت جديد">New Time</label><input type="time" id="newSlotTime"
                                class="form-control"></div><button class="btn btn-success" onclick="addTimeSlot()"
                            style="height: 42px;"><i class="fas fa-plus"></i> <span data-en="Add Slot"
                                data-ar="إضافة وقت">Add Slot</span></button>
                    </div>
                    <div id="slotsContainer"></div><button class="btn btn-primary" onclick="saveDaySchedule()"
                        style="width: 100%; margin-top: 20px;"><span data-en="Save Schedule" data-ar="حفظ الجدول">Save
                            Schedule</span></button>
                </div>
            </div>

            <div id="homework" class="panel" style="display:none;">
                <h2 data-en="Homework Manager" data-ar="إدارة الواجبات">Homework Manager</h2>
                <div style="display:flex; gap:20px; flex-wrap:wrap;">
                    <div style="flex:1; background: white; padding: 2rem; border-radius: 10px;">
                        <h4 data-en="Post New Assignment" data-ar="نشر واجب جديد">Post New Assignment</h4>
                        <div class="mb-3"><label data-en="Class" data-ar="الصف">Class</label><select id="hwClass"
                                class="form-control class-dropdown"></select></div>
                        <div class="mb-3"><label data-en="Subject" data-ar="المادة">Subject</label><select
                                id="hwSubject" class="form-control">
                                <option value="Math">Math</option>
                                <option value="Science">Science</option>
                                <option value="English">English</option>
                                <option value="Arabic">Arabic</option>
                            </select></div>
                        <div class="mb-3"><label data-en="Due Date" data-ar="تاريخ التسليم">Due Date</label><input
                                type="date" id="hwDate" class="form-control"></div>
                        <div class="mb-3"><textarea id="hwDesc" class="form-control" rows="3"
                                placeholder="Assignment details..."></textarea></div><button
                            class="btn btn-primary w-100" onclick="postHomework()"><span data-en="Post Assignment"
                                data-ar="نشر الواجب">Post Assignment</span></button>
                    </div>
                    <div style="flex:1; background: white; padding: 2rem; border-radius: 10px;">
                        <h4 data-en="Active Assignments" data-ar="الواجبات الحالية">Active Assignments</h4>
                        <div id="homeworkListContainer" style="max-height: 400px; overflow-y: auto; margin-top:15px;">
                        </div>
                    </div>
                </div>
            </div>

            <div id="bus" class="panel" style="display:none;">
                <h2 data-en="Bus Route Manager" data-ar="إدارة الحافلات">Bus Route Manager</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div style="background: white; padding: 20px; border-radius: 10px;">
                        <h4 style="color: #f39c12;" data-en="Morning Route" data-ar="المسار الصباحي">Morning Route</h4>
                        <div style="display: flex; gap: 10px; margin-bottom: 15px;"><input type="text"
                                id="busMorningLoc" placeholder="Stop Name" class="form-control"><input type="time"
                                id="busMorningTime" class="form-control" style="width: 120px;"><button
                                class="btn btn-primary" onclick="addBusStop('morning')">+</button></div>
                        <div id="morningBusList"></div>
                    </div>
                    <div style="background: white; padding: 20px; border-radius: 10px;">
                        <h4 style="color: #2c3e50;" data-en="Afternoon Route" data-ar="المسار المسائي">Afternoon Route
                        </h4>
                        <div style="display: flex; gap: 10px; margin-bottom: 15px;"><input type="text"
                                id="busEveningLoc" placeholder="Stop Name" class="form-control"><input type="time"
                                id="busEveningTime" class="form-control" style="width: 120px;"><button
                                class="btn btn-primary" onclick="addBusStop('evening')">+</button></div>
                        <div id="eveningBusList"></div>
                    </div>
                </div>
            </div>

            <div id="lunch" class="panel" style="display:none;">
                <h2 data-en="Lunch Menu Manager" data-ar="إدارة قائمة الغداء">Lunch Menu Manager</h2>
                <div style="display:flex; gap:20px; flex-wrap:wrap; margin-top: 20px;">
                    <div style="flex:1; background:white; padding:2rem; border-radius:10px;">
                        <h4 data-en="Add Item" data-ar="إضافة عنصر">Add Item</h4>
                        <form onsubmit="addLunchItem(event)"><input type="text" id="lunchName" class="form-control"
                                placeholder="Item Name" required><select id="lunchCategory" class="form-control">
                                <option value="sandwiches">Sandwiches</option>
                                <option value="snacks">Snacks</option>
                                <option value="drinks">Drinks</option>
                            </select><input type="number" id="lunchPrice" step="0.05" class="form-control"
                                placeholder="Price (JOD)" required>
                            <div class="drop-zone" id="lunchDropZone">
                                <div id="lunchDropText">Drag Image Here or Click</div><img id="lunchPreview"><input
                                    type="file" id="lunchImageInput" accept="image/*" hidden>
                            </div><button type="submit" class="btn btn-primary" style="width:100%;"><span data-en="Add"
                                    data-ar="إضافة">Add</span></button>
                        </form>
                    </div>
                    <div style="flex:2; background:white; padding:2rem; border-radius:10px;">
                        <h4><span data-en="Current Menu" data-ar="القائمة الحالية">Current Menu</span> <button
                                class="btn btn-danger" onclick="clearLunchMenu()"
                                style="float:right; font-size:0.7rem;">Clear All</button></h4>
                        <ul id="adminLunchList" style="list-style:none; padding:0;"></ul>
                    </div>
                </div>
            </div>

            <div id="gallery" class="panel" style="display:none;">
                <h2 data-en="Gallery Manager" data-ar="إدارة المعرض">Gallery Manager</h2>
                <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <div style="display: flex; gap: 10px;"><input type="text" id="galleryCaption" placeholder="Caption"
                            class="form-control"><input type="file" id="galleryInput" accept="image/*"
                            class="form-control"><button class="btn btn-primary"
                            onclick="uploadGalleryImage()">Upload</button></div>
                </div>
                <div class="gallery-grid" id="adminGalleryGrid"></div>
            </div>

            <div id="messages" class="panel" style="display:none;">
                <h2 data-en="School Broadcast" data-ar="إذاعة المدرسة">School Broadcast</h2>
                <div style="display: flex; gap: 20px; flex-wrap: wrap;">

                    <div style="flex: 1; background: white; padding: 2rem; border-radius: 10px;">
                        <h4 style="margin-bottom: 20px; color: #e74c3c;" data-en="Compose Message"
                            data-ar="إنشاء رسالة">Compose Message</h4>

                        <div class="mb-3">
                            <label class="fw-bold text-muted small mb-2" data-en="Recipient Type"
                                data-ar="نوع المستلم">Recipient Type</label>
                            <div class="d-flex gap-3 mb-2">
                                <label style="cursor:pointer;"><input type="radio" name="broadcastType" value="all"
                                        checked onchange="toggleBroadcastTarget()"> <span data-en="All Classes"
                                        data-ar="كل الصفوف">All Classes</span></label>
                                <label style="cursor:pointer;"><input type="radio" name="broadcastType" value="class"
                                        onchange="toggleBroadcastTarget()"> <span data-en="Specific Class"
                                        data-ar="صف محدد">Specific Class</span></label>
                                <label style="cursor:pointer;"><input type="radio" name="broadcastType" value="student"
                                        onchange="toggleBroadcastTarget()"> <span data-en="Specific Student"
                                        data-ar="طالب محدد">Specific Student</span></label>
                            </div>

                            <div id="broadcastClassContainer" style="display:none;">
                                <select id="broadcastClassSelect" class="form-control class-dropdown"></select>
                            </div>
                            <div id="broadcastStudentContainer" style="display:none;">
                                <select id="broadcastStudentSelect" class="form-control"></select>
                            </div>
                        </div>

                        <input type="text" id="adminMsgTitle" class="form-control" placeholder="Title">
                        <textarea id="adminMsgBody" class="form-control" rows="5" placeholder="Message..."></textarea>

                        <button class="btn btn-primary" onclick="sendAdminBroadcast()"
                            style="width: 100%; margin-top:10px;">
                            <span data-en="Send Broadcast" data-ar="إرسال الإعلان">Send Broadcast</span>
                        </button>
                    </div>

                    <div style="flex: 1; background: white; padding: 2rem; border-radius: 10px;">
                        <h4 style="margin-bottom: 20px;" data-en="Recent Broadcasts" data-ar="الإعلانات الأخيرة">Recent
                            Broadcasts</h4>
                        <div id="adminMsgHistory">
                            <p class="text-muted small">No broadcasts sent yet.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="settings" class="panel" style="display:none;">
                <h2 data-en="System Settings" data-ar="إعدادات النظام" style="margin-bottom: 20px;">System Settings</h2>

                <div class="row" style="display: flex; gap: 20px; flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 300px;">
                        <div class="settings-card">
                            <h4 class="settings-header"><i class="fas fa-university"></i> <span data-en="School Profile"
                                    data-ar="ملف المدرسة">School Profile</span></h4>
                            <div class="mb-3"><label data-en="School Name" data-ar="اسم المدرسة">School
                                    Name</label><input type="text" id="settingSchoolName" class="form-control"
                                    placeholder="Viola Academy"></div>
                            <div class="mb-3"><label data-en="Contact Phone" data-ar="رقم الهاتف">Contact
                                    Phone</label><input type="text" id="settingPhone" class="form-control"
                                    placeholder="+962 79 000 0000"></div>

                            <div class="mb-3">
                                <label data-en="Admin Password" data-ar="كلمة مرور المسؤول">Admin Password</label>
                                <input type="text" id="settingAdminPass" class="form-control" placeholder="admin123">
                            </div>

                            <button class="btn btn-primary" onclick="saveSettings()"><span data-en="Save Profile"
                                    data-ar="حفظ الملف">Save Profile</span></button>
                        </div>
                    </div>
                    <div style="flex: 1; min-width: 300px;">
                        <div class="settings-card">
                            <h4 class="settings-header"><i class="fas fa-calendar-alt"></i> <span
                                    data-en="Academic Configuration" data-ar="الإعدادات الأكاديمية">Academic
                                    Configuration</span></h4>
                            <div class="mb-3"><label data-en="Current Academic Year"
                                    data-ar="السنة الدراسية الحالية">Current Academic Year</label><input type="text"
                                    id="settingYear" class="form-control" placeholder="e.g. 2025-2026"></div>
                            <div class="mb-3"><label data-en="System Language Default"
                                    data-ar="لغة النظام الافتراضية">System Language Default</label><select
                                    id="settingLanguage" class="form-control">
                                    <option value="English">English</option>
                                    <option value="Arabic">Arabic</option>
                                </select></div>
                            <button class="btn btn-primary" onclick="saveSettings()"><span data-en="Update Settings"
                                    data-ar="تحديث الإعدادات">Update Settings</span></button>
                        </div>
                    </div>
                </div>

                <div class="row" style="margin-top: 10px;">
                    <div style="width: 100%;">
                        <div class="settings-card" style="border-left: 5px solid #3498db;">
                            <h4 class="settings-header"><i class="fas fa-database"></i> <span data-en="Data Management"
                                    data-ar="إدارة البيانات">Data Management</span></h4>
                            <p class="text-muted"
                                data-en="Download a full backup of your system data including students, grades, and finances."
                                data-ar="تحميل نسخة احتياطية كاملة لبيانات النظام.">Download a full backup.</p>
                            <button class="btn btn-info" onclick="backupData()"><i class="fas fa-download"></i> <span
                                    data-en="Download JSON Backup" data-ar="تحميل نسخة احتياطية">Download JSON
                                    Backup</span></button>
                        </div>

                        <div class="settings-card" style="border-left: 5px solid #e74c3c; background: #fff5f5;">
                            <h4 class="settings-header" style="color: #c0392b;"><i
                                    class="fas fa-exclamation-triangle"></i> <span data-en="Danger Zone"
                                    data-ar="منطقة الخطر">Danger Zone</span></h4>

                            <div style="margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #ffcccc;">
                                <h5 style="color: #c0392b; margin-bottom: 10px;" data-en="Class Operations"
                                    data-ar="عمليات الصفوف">Class Operations</h5>
                                <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                                    <div style="flex: 1;">
                                        <label class="small text-danger fw-bold" data-en="1. Transfer Students"
                                            data-ar="1. نقل الطلاب">1. Transfer Students</label>
                                        <button class="btn btn-warning w-100" onclick="openTransferModal()">
                                            <i class="fas fa-exchange-alt"></i> <span data-en="Open Transfer Tool"
                                                data-ar="فتح أداة النقل">Open Transfer Tool</span>
                                        </button>
                                    </div>
                                    <div style="flex: 1;">
                                        <label class="small text-danger fw-bold" data-en="2. Delete Class Roster"
                                            data-ar="2. حذف قائمة الصف">2. Delete Class Roster</label>
                                        <div style="display: flex; gap: 5px;">
                                            <select id="deleteClassSelect" class="form-control class-dropdown"
                                                style="border-color: #e74c3c;"></select>
                                            <button class="btn btn-danger" onclick="deleteClassRoster()">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <p style="color: #c0392b; font-size: 0.9rem;"
                                data-en="Factory Reset: This action will delete ALL students, teachers, and records."
                                data-ar="إعادة ضبط المصنع: هذا الإجراء سيحذف جميع البيانات.">Factory Reset: This action
                                will delete ALL students, teachers, and records.</p>
                            <button class="btn btn-danger" onclick="factoryReset()"><i class="fas fa-trash"></i> <span
                                    data-en="Factory Reset System" data-ar="إعادة ضبط المصنع">Factory Reset
                                    System</span></button>
                        </div>
                    </div>
                </div>
            </div>
            <div id="website-editor" class="panel" style="display:none;">
                <h2 data-en="Website Content Editor" data-ar="محرر محتوى الموقع" style="margin-bottom: 20px;">Website
                    Content Editor</h2>

                <div
                    style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 20px; display: flex; gap: 10px; overflow-x: auto;">
                    <button class="btn btn-secondary" onclick="showWebSection('web-about')">About Us</button>
                    <button class="btn btn-secondary" onclick="showWebSection('web-features')">Core Functions</button>
                    <button class="btn btn-secondary" onclick="showWebSection('web-testimonials')">Testimonials</button>
                    <button class="btn btn-secondary" onclick="showWebSection('web-footer')">Footer</button>
                </div>

                <div id="web-about" class="web-section" style="background: white; padding: 20px; border-radius: 10px;">
                    <h4 style="margin-bottom: 20px; color: var(--primary);">About Us Section</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <div class="mb-3"><label>Main Title</label><input type="text" id="editAboutTitle"
                                    class="form-control"></div>
                            <div class="mb-3"><label>Description</label><textarea id="editAboutDesc"
                                    class="form-control" rows="5"></textarea></div>
                            <div class="mb-3"><label>Highlight Quote</label><input type="text" id="editAboutQuote"
                                    class="form-control"></div>
                            <div class="mb-3"><label>Quote Author</label><input type="text" id="editAboutAuthor"
                                    class="form-control"></div>
                        </div>
                        <div>
                            <label>About Image</label>
                            <div class="drop-zone" onclick="document.getElementById('editAboutImgInput').click()"
                                style="height: 250px;">
                                <p>Click to Upload Image</p>
                                <img id="editAboutPreview" class="preview-img"
                                    style="display:block; width:100%; height:100%; object-fit:cover;">
                                <input type="file" id="editAboutImgInput" hidden accept="image/*"
                                    onchange="previewWebImage(this, 'editAboutPreview')">
                            </div>
                        </div>
                    </div>
                </div>

                <div id="web-features" class="web-section"
                    style="display:none; background: white; padding: 20px; border-radius: 10px;">
                    <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
                        <h4 style="color: var(--primary);">Core Functions</h4>
                        <button class="btn btn-success" onclick="addFeatureItem()">+ Add Function</button>
                    </div>
                    <div id="featuresListContainer"></div>
                </div>

                <div id="web-testimonials" class="web-section"
                    style="display:none; background: white; padding: 20px; border-radius: 10px;">
                    <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
                        <h4 style="color: var(--primary);">Parent Testimonials</h4>
                        <button class="btn btn-success" onclick="addTestimonialItem()">+ Add Testimonial</button>
                    </div>
                    <div id="testimonialsListContainer"></div>
                </div>

                <div id="web-footer" class="web-section"
                    style="display:none; background: white; padding: 20px; border-radius: 10px;">
                    <h4 style="margin-bottom: 20px; color: var(--primary);">Footer Information</h4>

                    <h5 style="color: #666; margin-top: 15px;">Viola Academy Column</h5>
                    <div class="mb-3"><label>School Description</label><textarea id="editFooterDesc"
                            class="form-control" rows="2"></textarea></div>

                    <h5 style="color: #666; margin-top: 15px;">Contact Us Column</h5>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div><label>Address</label><input type="text" id="editFooterAddr" class="form-control"></div>
                        <div><label>Phone</label><input type="text" id="editFooterPhone" class="form-control"></div>
                        <div style="grid-column: span 2;"><label>Email</label><input type="text" id="editFooterEmail"
                                class="form-control"></div>
                    </div>

                    <h5 style="color: #666; margin-top: 15px;">Follow Us Column (Links)</h5>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div><label>Facebook Link</label><input type="text" id="editSocialFb" class="form-control"
                                placeholder="#"></div>
                        <div><label>Instagram Link</label><input type="text" id="editSocialInsta" class="form-control"
                                placeholder="#"></div>
                        <div><label>Twitter Link</label><input type="text" id="editSocialTwitter" class="form-control"
                                placeholder="#"></div>
                        <div><label>LinkedIn Link</label><input type="text" id="editSocialLinkedin" class="form-control"
                                placeholder="#"></div>
                    </div>
                </div>

                <hr style="margin: 30px 0;">
                <button class="btn btn-primary" style="width: 100%; padding: 15px; font-size: 1.2rem;"
                    onclick="saveWebsiteContent()">
                    <i class="fas fa-save"></i> Publish Changes to Website
                </button>
            </div>

        </div>
    </div>

    <div id="transferModal" class="modal">
        <div class="modal-content">
            <div style="display:flex; justify-content:space-between;">
                <h3 data-en="Transfer Students" data-ar="نقل الطلاب">Transfer Students</h3><span
                    onclick="closeModal('transferModal')" style="cursor:pointer; font-size:1.5rem;">&times;</span>
            </div>
            <div class="mb-3">
                <label data-en="From Class (Source)" data-ar="من الصف (المصدر)">From Class (Source)</label>
                <select id="transferSourceClass" class="form-control class-dropdown"
                    onchange="renderTransferList()"></select>
            </div>
            <div class="transfer-list" id="transferListContainer">
                <p class="text-center text-muted" data-en="Select a source class." data-ar="اختر الصف المصدر.">Select a
                    source class.</p>
            </div>
            <div class="mb-3">
                <label data-en="To Class (Target)" data-ar="إلى الصف (الهدف)">To Class (Target)</label>
                <select id="transferTargetClass" class="form-control class-dropdown"></select>
            </div>
            <div style="text-align: right;">
                <button class="btn btn-secondary" onclick="closeModal('transferModal')">Cancel</button>
                <button class="btn btn-primary" onclick="executeTransfer()">Transfer Selected</button>
            </div>
        </div>
    </div>

    <div id="studentModal" class="modal">
        <div class="modal-content">
            <div style="display:flex; justify-content:space-between;">
                <h2 data-en="Create Student Account" data-ar="إنشاء حساب طالب">Create Student Account</h2><span
                    onclick="closeModal('studentModal')" style="cursor:pointer; font-size:1.5rem;">&times;</span>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <input type="hidden" id="editIndex">
                <div class="login-section">
                    <h4 style="margin-bottom:10px; color:#1976d2;"><i class="fas fa-lock"></i> <span
                            data-en="Parent Login Credentials" data-ar="بيانات دخول ولي الأمر">Parent Login
                            Credentials</span></h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div><label data-en="Student ID (Username)" data-ar="رقم الطالب (اسم المستخدم)">Student ID
                                (Username)</label><input type="number" id="sID" class="form-control"
                                placeholder="e.g. 202601"></div>
                        <div><label data-en="Password" data-ar="كلمة المرور">Password</label><input type="text"
                                id="sPass" class="form-control" value="123456" placeholder="Default: 123456"></div>
                    </div>
                </div>
                <div style="grid-column: span 2;"><label data-en="Full Name" data-ar="الاسم الكامل">Full
                        Name</label><input type="text" id="sName" class="form-control" placeholder="Student Full Name">
                </div>
                <div><label data-en="Section" data-ar="القسم">Section</label><select id="sGrade"
                        class="form-control class-dropdown"></select></div>
                <div><label data-en="Total Fee (JOD)" data-ar="الرسوم الكلية (دينار)">Total Fee (JOD)</label><input
                        type="number" id="sFee" value="1000" class="form-control"></div>
                <div><label data-en="Amount Paid" data-ar="المبلغ المدفوع">Amount Paid</label><input type="number"
                        id="sPaid" value="0" class="form-control"></div>
                <div><label data-en="Credit Balance (JOD)" data-ar="الرصيد (دينار)">Credit Balance (JOD)</label><input
                        type="number" id="sCredit" value="0" class="form-control" step="0.01"></div>
                <div style="grid-column: span 2;"><label data-en="Student Photo" data-ar="صورة الطالب">Student
                        Photo</label><input type="file" id="studentPhoto" accept="image/*" class="form-control"></div>
            </div>
            <div style="margin-top:20px; text-align:right;">
                <button class="btn btn-secondary" onclick="closeModal('studentModal')"><span data-en="Cancel"
                        data-ar="إلغاء">Cancel</span></button>
                <button class="btn btn-primary" onclick="saveStudent()"><span data-en="Save Account"
                        data-ar="حفظ الحساب">Save Account</span></button>
            </div>
        </div>
    </div>

    <div id="teacherModal" class="modal">
        <div class="modal-content">
            <div style="display:flex; justify-content:space-between;">
                <h2 data-en="Teacher Details" data-ar="تفاصيل المعلم">Teacher Details</h2><span
                    onclick="closeModal('teacherModal')" style="cursor:pointer; font-size:1.5rem;">&times;</span>
            </div>
            <input type="hidden" id="teacherIndex">
            <div class="mb-3"><label data-en="Full Name" data-ar="الاسم الكامل">Full Name</label><input type="text"
                    id="tName" class="form-control" placeholder="Ms. Sarah"></div>
            <div class="mb-3"><label data-en="Assigned Class" data-ar="الصف المعين">Assigned Class</label><select
                    id="tClass" class="form-control class-dropdown"></select></div>
            <div class="mb-3"><label data-en="Username" data-ar="اسم المستخدم">Username</label><input type="text"
                    id="tUser" class="form-control" placeholder="Username"></div>
            <div class="mb-3"><label data-en="Password" data-ar="كلمة المرور">Password</label><input type="text"
                    id="tPass" class="form-control" placeholder="Password"></div>
            <div style="margin-top:20px; text-align:right;">
                <button class="btn btn-secondary" onclick="closeModal('teacherModal')"><span data-en="Cancel"
                        data-ar="إلغاء">Cancel</span></button>
                <button class="btn btn-primary" onclick="saveTeacher()"><span data-en="Save Teacher"
                        data-ar="حفظ المعلم">Save Teacher</span></button>
            </div>
        </div>
    </div>

    <script type="module" src="main.js"></script>
    <script type="module" src="js/admin_dashboard.js"></script>
    <div id="toast-container"
        style="position: fixed; bottom: 20px; right: 20px; z-index: 10000; display: flex; flex-direction: column; gap: 10px;">
    </div>


</body>

</html>